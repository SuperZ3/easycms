(this.webpackJsonpantdpro=this.webpackJsonpantdpro||[]).push([[0],{138:function(e,t,n){},198:function(e,t,n){e.exports=n(385)},207:function(e,t,n){},384:function(e,t,n){},385:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(5),s=n.n(r),o=n(91);var l=Object(o.b)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isLogin:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"IS_LOGIN":e={isLogin:!0};break;case"IS_OUT":e={isLogin:!1}}return e})),c=n(44),u=(n(207),n(192)),d=n(8),h=n(195),m=n(29),p=n(30),g=n(12),f=n(32),b=n(31),v=n(388),y=n(35),E=n(33),w=n.n(E),F=n(165),j=n.n(F),k=function(e){Object(f.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(m.a)(this,n),(a=t.call(this,e)).name=e.name,a.onFinish=e.onFinish||"",a.onFinishField=e.onFinishField||"",a.action=e.action,a.onSubmit=a.onSubmit.bind(Object(g.a)(a)),a.addDepend=a.addDepend.bind(Object(g.a)(a)),a.getFieldValue=a.getFieldValue.bind(Object(g.a)(a)),a}return Object(p.a)(n,[{key:"getFieldValue",value:function(e){return this.refs[e].value}},{key:"addDepend",value:function(e,t){this.refs[e].listener.push(t)}},{key:"onSubmit",value:function(e){var t=this,n={},a=this.refs,i=this.action;this.validate(a,n)&&w()({method:"post",url:i,data:j.a.stringify(n)}).then((function(e){0===e.data.code?t.onFinish(e.data):t.onFinishField(e.data)})).catch((function(e){t.onFinishField(e)})),e.preventDefault()}},{key:"validate",value:function(e,t){return Object.keys(e).every((function(n){var a=e[n];return t[n]=a.value,a.validator(a.rules,a.value)&&!a.state.sign}))}},{key:"render",value:function(){var e=this,t=i.a.Children.map(this.props.children,(function(t){return i.a.cloneElement(t,{ref:t.props.name,addDepend:e.addDepend,getFieldValue:e.getFieldValue})}));return i.a.createElement("form",{onSubmit:this.onSubmit,noValidate:!0},t)}}]),n}(i.a.Component),x=function(e){Object(f.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(m.a)(this,n),(a=t.call(this,e)).width=e.width||"700px",a.rules=e.rules||[],a.required=!!a.rules.find((function(e){return!0===e.required})),a.label=e.label||"",a.name=e.name||"",a.dependencies=e.dependencies||"",a.onChange=a.onChange.bind(Object(g.a)(a)),a.listener=[],a.addDepend=e.addDepend,a.getFieldValue=e.getFieldValue,a.value="",a.state={sign:""},a}return Object(p.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.dependencies.length>=1&&this.dependencies.forEach((function(t){e.addDepend(t,e)}))}},{key:"onChange",value:function(e){var t=this,n=e.target.value,a=e.target.name,i=this.getFieldValue,r=this.rules,s=r.find((function(e){return"function"===typeof e}));if(s)try{s({getFieldValue:i}).validator(this.rules,n).catch((function(e){t.setState({sign:e})}))}catch(o){console.log("Error : need validator")}this.validator(r,n,a,s,i)}},{key:"validator",value:function(e,t,n){var a=this,i=!e.some((function(e){return e.required&&!t||"email"===e.type&&t&&!/^[a-zA-Z0-9]+([-_.][a-zA-Z0-9]+)*@[a-zA-Z0-9]+([-_.][a-zA-Z0-9]+)*\.[a-z]{2,}$/.test(t)?(a.setState({sign:e.message}),!0):void(a.value="")}));return i&&(this.setState({sign:""}),this.value=t,this.listener.length>=0&&this.listener.forEach((function(e){if(e.value){var t=e.getFieldValue,n=e.rules;n.find((function(e){return"function"===typeof e}))({getFieldValue:t}).validator(n,e.value).then((function(t){e.setState({sign:""})})).catch((function(t){e.setState({sign:t})}))}}))),i}},{key:"render",value:function(){var e,t;this.rules.forEach((function(n){n.type?e=n.type:n.required&&(t=n.required)}));var n=this.props.children.props.htmlType in{submit:"submit",button:"button",reset:"reset"};return i.a.createElement("div",{style:{display:"flex",marginBottom:"20px",justifyContent:"center",alignItems:"flex-start"}},n?"":i.a.createElement("label",{htmlFor:this.label,style:{marginRight:"10px",marginTop:"5px",width:"120px"}},t?i.a.createElement("span",{style:{color:"red"}},"*"):"",this.label," :"),i.a.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"flex-start"}},i.a.cloneElement(this.props.children,{name:this.name,title:"",type:e,onChange:this.onChange,style:{width:this.width,border:this.state.sign?"1px solid red":""}}),this.state.sign?i.a.createElement("span",{style:{color:"red",float:"left",margin:"0px"}},this.state.sign):""))}}]),n}(i.a.PureComponent),O=(n(138),{login:function(e){return{type:"IS_LOGIN",payload:e}},out:function(e){return{type:"IS_OUT"}}}),S=function(e){Object(f.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(m.a)(this,n),(a=t.call(this,e)).state={wrong:""},a.onFinishField=a.onFinishField.bind(Object(g.a)(a)),a.onFinish=a.onFinish.bind(Object(g.a)(a)),a.runSign=a.runSign.bind(Object(g.a)(a)),a}return Object(p.a)(n,[{key:"onFinish",value:function(e){var t=e.token;window.localStorage.setItem("token",t),this.props.login()}},{key:"onFinishField",value:function(e){var t=e.message;this.setState({wrong:t})}},{key:"runSign",value:function(){this.props.history.push("/sign")}},{key:"render",value:function(){return this.props.isLogin?i.a.createElement(d.a,{to:"/"}):i.a.createElement("div",null,i.a.createElement("div",{style:{position:"fixed",display:"flex",flexDirection:"column",justifyContent:"space-around",alignItems:"center",top:"0",left:"0",width:"200px",height:"100px",border:"1px solid #e7e7e7"}},i.a.createElement("div",null,"\u9ed8\u8ba4\u7528\u6237\u540d:zhang"),i.a.createElement("div",null,"\u9ed8\u8ba4\u5bc6\u7801:1234")),i.a.createElement("div",{className:"indexImg"}),this.state.wrong?i.a.createElement("span",{style:{color:"red"}},this.state.wrong):"",i.a.createElement(k,{action:"/api/login",onFinish:this.onFinish,onFinishField:this.onFinishField},i.a.createElement(x,{label:"username",name:"username",rules:[{required:!0,message:"Please input your username!"}]},i.a.createElement(v.a,null)),i.a.createElement(x,{label:"password",name:"password",rules:[{type:"password",message:"not password"},{required:!0,message:"Please input password!"}]},i.a.createElement(v.a,null)),i.a.createElement(x,{width:"200px"},i.a.createElement(y.a,{type:"primary",htmlType:"submit"},"\u767b\u5f55")),i.a.createElement(x,{width:"200px"},i.a.createElement(y.a,{type:"primary",htmlType:"button",onClick:this.runSign},"\u6ce8\u518c"))))}}]),n}(i.a.Component),I=Object(c.b)((function(e){return Object(h.a)({},e)}),O)(S),C=n(126),z=n.n(C),D=n(169),V=function(e){Object(f.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(m.a)(this,n),(a=t.call(this,e)).onFinishField=a.onFinishField.bind(Object(g.a)(a)),a.onFinish=a.onFinish.bind(Object(g.a)(a)),a.getCaptcha=a.getCaptcha.bind(Object(g.a)(a)),a.state={captcha:"\u53d1\u9001\u9a8c\u8bc1\u7801",sign:!0,wrong:"",gologin:""},a}return Object(p.a)(n,[{key:"onFinish",value:function(e){this.state.gologin&&this.state.sign&&this.props.history.replace("/login")}},{key:"onFinishField",value:function(e){var t=e.message;this.setState({wrong:t})}},{key:"getCaptcha",value:function(){var e=Object(D.a)(z.a.mark((function e(t){var n,a,i,r=this;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=this.refs.c1.refs.email.value)?(a=60,this.state.sign&&(i=setInterval((function(){a>0?r.setState({captcha:"("+a--+"s)\u91cd\u65b0\u53d1\u9001",sign:!1}):(r.setState({captcha:"\u53d1\u9001\u9a8c\u8bc1\u7801",sign:!0}),i&&clearInterval(i))}),1e3),w.a.get("/api/captcha",{params:{email:n}}).then((function(e){var t=e.data,n=t.code,a=t.message;1===n?(r.setState({wrong:a+"\u90ae\u7bb1\u4e0d\u5b58\u5728",captcha:"\u53d1\u9001\u9a8c\u8bc1\u7801",sign:!0}),i&&clearInterval(i)):0===n&&(console.log("captcha 666"),i&&clearInterval(i),r.setState({sign:!0,captcha:"\u53d1\u9001\u6210\u529f",wrong:"",gologin:!0}))})).catch((function(e){r.setState({wrong:e.message,captcha:"\u53d1\u9001\u9a8c\u8bc1\u7801",sign:!0}),i&&clearInterval(i)})))):this.setState({wrong:"\u8bf7\u586b\u5199\u90ae\u7bb1"});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return i.a.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",marginTop:"-130px",marginLeft:"-415px"}},this.state.wrong?i.a.createElement("span",{style:{color:"red"}},this.state.wrong):"",i.a.createElement(k,{action:"/api/register",onFinish:this.onFinish,onFinishField:this.onFinishField,ref:"c1"},i.a.createElement(x,{label:"username",name:"username",rules:[{required:!0,message:"Please input your username!"}]},i.a.createElement(v.a,null)),i.a.createElement(x,{label:"password",name:"password",rules:[{type:"password",message:"not password"},{required:!0,message:"Please input password!"}]},i.a.createElement(v.a,null)),i.a.createElement(x,{label:"confirmpassword",name:"confirmpassword",dependcies:["password"],rules:[{type:"password",message:"not password"},{required:!0,message:"Please input password!"},function(e){var t=e.getFieldValue;return{validator:function(e,n){return n&&t("password")!==n?Promise.reject("The two passwords that you entered do not match!"):Promise.resolve()}}}]},i.a.createElement(v.a,null)),i.a.createElement(x,{label:"email",name:"email",rules:[{type:"email",message:"not a email!"},{required:!0,message:"Please input password!"}]},i.a.createElement(v.a,null)),i.a.createElement(x,{label:"captcha",name:"captcha",noStyle:!0,rules:[{required:!0,message:"Please input the captcha you got!"}]},i.a.createElement(v.a,null)),i.a.createElement(x,{width:"200px"},i.a.createElement(y.a,{type:"primary",htmlType:"button",onClick:this.getCaptcha},this.state.captcha)),i.a.createElement(x,{width:"200px"},i.a.createElement(y.a,{type:"primary",htmlType:"submit"},"\u6ce8\u518c"))))}}]),n}(i.a.Component),q=n(386),P=n(387),T=function(e){Object(f.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(m.a)(this,n),(a=t.call(this,e)).zancun="",a.state={datawant:"",columns:"",btext:"\u627e9\u5e74\u4ee5\u4e0b"},a.lessNine=a.lessNine.bind(Object(g.a)(a)),a.del=a.del.bind(Object(g.a)(a)),a}return Object(p.a)(n,[{key:"componentDidMount",value:function(){var e=this;w.a.get("/data/person").then((function(t){var n=t.data,a=[],r=[{title:"Avatar",dataIndex:"avatar",key:"avatar",render:function(e){return i.a.createElement("img",{style:{width:"150px",height:"150px"},src:""+e,alt:"loading..."})}},{title:"Personname",dataIndex:"personname",key:"personname"},{title:"Jobnumber",dataIndex:"jobnumber",key:"jobnumber"},{title:"Years",dataIndex:"years",key:"years"},{title:"Action",key:"action",render:function(t,n){return i.a.createElement(q.a,{size:"middle"},i.a.createElement(y.a,{type:"danger",onClick:function(){return e.del(t,n)}},"Delete"))}}];n.forEach((function(e){a.push({key:e._id,avatar:e.avatar,personname:e.personname,jobnumber:e.jobnumber,years:e.years})})),e.setState({datawant:a,columns:r})}))}},{key:"del",value:function(e,t){var n=this,a="/data/person/"+t.jobnumber;w.a.delete(a).then((function(e){w.a.get("/data/person").then((function(e){var t=e.data,a=[],r=[{title:"Avatar",dataIndex:"avatar",key:"avatar",render:function(e){return i.a.createElement("img",{style:{width:"150px",height:"150px"},src:""+e,alt:"loading..."})}},{title:"Personname",dataIndex:"personname",key:"personname"},{title:"Jobnumber",dataIndex:"jobnumber",key:"jobnumber"},{title:"Years",dataIndex:"years",key:"years"},{title:"Action",key:"action",render:function(e,t){return i.a.createElement(q.a,{size:"middle"},i.a.createElement(y.a,{type:"danger",onClick:function(){return n.del(e,t)}},"Delete"))}}];t.forEach((function(e){a.push({key:e._id,avatar:e.avatar,personname:e.personname,jobnumber:e.jobnumber,years:e.years})})),n.setState({datawant:a,columns:r})}))})).catch((function(e){console.log(e)}))}},{key:"lessNine",value:function(){var e=[];if(this.zancun)this.setState({datawant:this.zancun,btext:"\u627e9\u5e74\u4ee5\u4e0b"}),this.zancun="";else{this.zancun=this.state.datawant,this.state.datawant.forEach((function(t){e.push(t)}));var t=e.filter((function(e){return parseInt(e.years)<9}));this.setState({datawant:t,btext:"\u5168\u90e8"})}}},{key:"render",value:function(){return i.a.createElement("div",{style:{width:"800px",margin:"10px auto"}},i.a.createElement(y.a,{onClick:this.lessNine},this.state.btext),i.a.createElement(P.a,{style:{marginTop:"10px"},size:"small",pagination:{position:["bottomCenter"],count:"12",pageSize:"3"},columns:this.state.columns,dataSource:this.state.datawant}))}}]),n}(i.a.Component),A=Object(c.b)((function(e){return e}),O)(T),L=n(196);var N=Object(c.b)((function(e){return e}),O)((function(e){var t=e.component,n=e.isLogin,a=e.login,r=Object(L.a)(e,["component","isLogin","login"]),s=window.localStorage.getItem("token")||"";if(s)try{w.a.get("/api/gettoken",{headers:{Authorization:"Bearer ".concat(s)}}).then((function(e){a()})).catch((function(e){window.localStorage.removeItem("token"),alert("\u767b\u5f55\u8d85\u65f6,\u8bf7\u91cd\u65b0\u767b\u5f55")}))}catch(o){console.log("shame")}return i.a.createElement(d.b,{render:function(){return n?i.a.createElement(t,r):i.a.createElement(d.a,{to:{pathname:"/login"}})}})}));n(384);var _=function(){return i.a.createElement("div",{className:"App"},i.a.createElement(u.a,null,i.a.createElement(d.d,null,i.a.createElement(N,{path:"/",exact:!0,component:A}),i.a.createElement(d.b,{path:"/login",component:I}),i.a.createElement(d.b,{path:"/sign",component:V}),i.a.createElement(d.b,{render:function(){return i.a.createElement("div",null,"404")}}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(c.a,{store:l},i.a.createElement(_,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[198,1,2]]]);
//# sourceMappingURL=main.4b05171a.chunk.js.map